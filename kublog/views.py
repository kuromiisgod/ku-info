from django.template.response import TemplateResponse
from django.core.paginator import Paginator, PageNotAnInteger , EmptyPage
from kublog.forms import ContactForm, PostOneForm, PostSearchForm
from kublog.models import PostOne
from django.http import HttpResponseRedirect, Http404, HttpResponse
from kublog import consts
from django.urls import reverse
from django.db.models import Q
from myproject import settings
from django.core.mail import BadHeaderError, send_mail

place_list = [i for i,t in consts.PREFECTURES]

def login(request):
    """
    LOGINページ
    """
    return TemplateResponse(request,'login.html')

def home(request):
    """
    TOPページ
    - 記事の検索可能
    """
    if request.method == 'GET':
        if request.GET.get('keywords'):
            posts = PostOne.objects.order_by('date')
            form = PostSearchForm(request.GET)
            if form.is_valid():
                keywords = form.cleaned_data.get('keywords')
                posts = posts.filter(Q(title__contains=keywords) | Q(content__contains=keywords) | Q(date__contains=keywords) | Q(place__contains=keywords) | Q(created_by__contains=keywords))
                paginator = Paginator(posts,10)
                posts = paginator.page(1)
                if posts:
                    return TemplateResponse(request, 'search_post.html', {'posts':posts,'keywords':keywords})
                else:
                    return TemplateResponse(request, 'no_search_post.html')
            else:
                miss = 'invalid_form'
                return HttpResponseRedirect(reverse('home',kwargs={'miss':miss}))
        form = PostSearchForm()
        post_list = PostOne.objects.order_by('date')
        if post_list:
            paginator = Paginator(post_list,5)
            page = request.GET.get('page',1)
            try:
                post_list = paginator.page(page)
            except(PageNotAnInteger,EmptyPage):
                post_list = paginator.page(1)
        return TemplateResponse(request,'index.html', {'post_list':post_list,'form':form,})
    return HttpResponseRedirect(reverse('home'))

def append_post(request):
    """
    新規投稿追加
    """
    if request.method == 'GET':
        form = PostOneForm()
        return TemplateResponse(request, 'append_post.html', {'form':form})

    form = PostOneForm(request.POST)
    if form.is_valid():
        form.save()
        return HttpResponseRedirect(reverse('home'))
    return TemplateResponse(request, 'append_post.html', {'form':form})


def post_one(request,post_id):
    """
    投稿表示ページ
    """
    try:
        post = PostOne.objects.get(id=post_id)
        
    except PostOne.DoesNotExist:
        raise Http404

    return TemplateResponse(request, 'post_one.html', {'post':post})


def post_delete(request,post_id):
    """
    投稿削除
    """
    try:
        post = PostOne.objects.get(id=post_id)
        post.delete()
    except PostOne.DoesNotExist:
        raise Http404
    
    return HttpResponseRedirect(reverse('home'))

def post_edit(request,post_id): 
    """
    投稿編集
    """
    try:
        post = PostOne.objects.get(id=post_id)
        form = PostOneForm(instance=post)
    except PostOne.DoesNotExist:
        raise Http404
    if request.method == 'GET':
        return TemplateResponse(request, 'post_edit.html', {'form':form,'post':post})

    form = PostOneForm(request.POST,instance=post)
    post = PostOne.objects.get(id=post_id)
    if form.is_valid():
        form.save()
        return HttpResponseRedirect(reverse('home'))
    return TemplateResponse(request, 'post_edit.html', {'form':form,'post':post})

def contact_form(request):
    """
    お問い合わせ
    """
    if request.method == 'GET':
        form = ContactForm()
        return TemplateResponse(request, 'contact_form.html', {'form':form})

    form = ContactForm(request.POST)
    if form.is_valid():
        subject = form.cleaned_data['contact_name']
        message = form.cleaned_data['contact_message']
        sender = form.cleaned_data['contact_email']
        recipients = [settings.EMAIL_HOST_USER]
        try:
            send_mail(subject, message, sender, recipients)
        except BadHeaderError:
            return HttpResponse('無効なヘッダーが含まれています')
        form.save()
        return HttpResponseRedirect(reverse('home'))
    return TemplateResponse(request, 'contact_form.html', {'form':form})
  

honnkann = {'Monday':{'１時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':['１３０', '１３１', '１３３', '１３Ａ', '１３Ｄ'], '4階':['１４０', '１４１', '１４３', '１４５', '１４６', '１４７', '１４Ａ'],'5階':[ '１５０', '１５１', '１５３', '１５５', '１５７', '１５Ａ'],'6階':[ '１６６', '１６８', '１６Ａ']},'２時限':{'1階':['１１Ａ'],'3階':[ '１３０', '１３１', '１３２', '１３３', '１３Ａ', '１３Ｂ', '１３Ｄ'],'4階':[ '１４０', '１４１', '１４２', '１４３', '１４４', '１４５', '１４６', '１４７', '１４Ａ','２４４', '２４５', '２４７', '２４９'],'5階':[ '１５０', '１５２', '１５３', '１５４', '１５５', '１５６', '１５７', '１５Ａ','２５０', '２５１', '２５９'],'6階':[ '１６４', '１６６', '１６７', '１６８', '１６９', '１６Ａ']},'３時限':{'1階':['１１Ａ'], '2階':['１２Ａ'],'3階':[ '１３０', '１３１', '１３２', '１３３', '１３Ａ', '１３Ｂ', '１３Ｄ'],'4階':[ '１４０', '１４２', '１４５', '１４６', '１４７', '１４Ａ','２４０', '２４１', '２４３', '２４５', '２４８', '２４９'],'5階':[ '１５０', '１５１', '１５３', '１５４', '１５５', '１５６', '１５７', '１５Ａ', '２５２', '２５３', '２５４'],'6階':[ '１６０', '１６１', '１６２', '１６５', '１６６', '１６７', '１６８', '１６９'], '7階':[ 'ピアノ室', '音楽室']},'４時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３１', '１３３', '１３Ａ', '１３Ｄ'],'4階':[ '１４０', '１４２', '１４３', '１４４', '１４５', '１４６', '１４７', '１４Ａ','２４５'],'5階':[ '１５６', '１５７', '１５Ａ','２５０', '２５３', '２５４', '２５５', '２５８'],'6階':[ '１６０', '１６１', '１６４', '１６５', '１６９', '１６Ａ'],'7階':['ピアノ室', '音楽室'] },'５時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３１', '１３２'],'4階':[ '１４６', '２４３', '２４６', '２４７', '２４８'],'5階':['２５０', '２５１', '２５２', '２５５', '２５６', '２５７', '２５８'],'6階':[ '１６０', '１６５'], '7階':['ピアノ室', '音楽室']}},'Tuesday':{'１時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３１', '１３３', '１３Ａ', '１３Ｂ', '１３Ｄ'],'4階':[ '１４０', '１４１', '１４５', '１４６'],'6階':[ '１６５']},'２時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３１', '１３２', '１３３', '１３Ａ', '１３Ｄ'],'4階':[ '１４０', '１４１', '１４２', '１４３', '１４４', '１４５', '１４６', '１４７', '１４Ａ', '２４２', '２４３', '２４４', '２４７', '２４９'],'5階':[ '１５０', '１５２', '１５３', '１５４', '１５５', '１５６', '１５７', '１５Ａ', '２５２', '２５３', '２５６', '２５８'],'6階':[ '１６６', '１６７', '１６８', '１６９', '１６Ａ']},'３時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３１', '１３２', '１３Ａ', '１３Ｂ', '１３Ｄ'],'4階':[ '１４１', '１４３', '１４５', '１４６', '１４７', '１４Ａ', '２４０', '２４４', '２４６', '２４７', '２４８', '２４９'],'5階':[ '１５０', '１５１', '１５２', '１５４', '１５６', '１５７', '１５Ａ', '２５０', '２５１', '２５２', '２５３', '２５８', '２５９'],'6階':[ '１６０', '１６２', '１６６', '１６８', '１６９', '１６Ａ']},'４時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３１', '１３２', '１３３', '１３Ａ', '１３Ｂ', '１３Ｄ'],'4階':[ '１４３', '１４４', '１４５', '１４６', '１４７', '２４１', '２４４', '２４７', '２４９'],'5階':[ '１５０', '１５１', '１５２', '１５３', '１５４', '１５７', '１５Ａ', '２５３', '２５６', '２５７', '２５８', '２５９'],'6階':[ '１６２', '１６５', '１６６', '１６７', '１６８', '１６９']},'５時限':{'1階':[ '１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３１', '１３２', '１３３', '１３Ａ', '１３Ｄ'],'4階':[ '１４３', '１４５', '１４６', '１４７'],'6階':[ '１６５', '１６Ａ']}},'Wednesday':{'１時限':{'2階':['１２Ａ'],'3階':[ '１３２', '１３Ａ', '１３Ｄ'],'4階':[ '１４１', '１４５', '１４７', '１４Ａ', '２４０', '２４１', '２４２', '２４３', '２４５', '２４９'],'5階':[ '１５０', '１５Ａ', '２５０', '２５１', '２５２', '２５３', '２５４', '２５５', '２５６', '２５７', '２５８'],'6階':[ '１６０', '１６１', '１６４', '１６５', '１６Ａ'],'7階':['ピアノ室', '音楽室']},'２時限':{'1階':[ '１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３１', '１３２', '１３３', '１３Ａ', '１３Ｂ', '１３Ｄ'],'4階':[ '１４０', '１４１', '１４２', '１４４', '１４５', '１４６', '１４７', '１４Ａ', '２４０', '２４３', '２４４', '２４５', '２４６', '２４７', '２４８', '２４９'],'5階':[ '１５０', '１５１', '１５２', '１５４', '１５５', '１５６', '１５７', '１５Ａ', '２５０', '２５１', '２５２', '２５３', '２５４', '２５５', '２５６', '２５７', '２５８', '２５９'],'6階':[ '１６１', '１６２', '１６４', '１６５', '１６６', '１６７', '１６８', '１６９', '１６Ａ'],'7階':['図画工作室']},'３時限':{'1階':[ '１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３１', '１３２', '１３３', '１３Ａ', '１３Ｂ', '１３Ｄ'],'4階':[ '１４０', '１４１', '１４２', '１４３', '１４４', '１４５', '１４６', '１４７', '１４Ａ', '２４０', '２４１', '２４３', '２４４', '２４７', '２４９'],'5階':[ '１５０', '１５３', '１５４', '１５５', '１５７', '１５Ａ', '２５０', '２５３', '２５４', '２５５', '２５６', '２５９'],'6階':[ '１６０', '１６２', '１６４', '１６６', '１６８', '１６Ａ'],'7階':['図画工作室']},'４時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３１', '１３２', '１３３', '１３Ａ', '１３Ｄ'],'4階':[ '１４３', '１４４', '１４５', '１４６', '１４Ａ'],'5階':[ '１５０', '１５２', '１５４', '１５５', '２５９'],'6階':[ '１６８'], '7階':['図画工作室']},'５時限':{'3階':['１３２', '１３３'],'4階':[ '１４４'],'5階':[ '１５５', '２５９']}},'Thursday':{'１時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３１', '１３２', '１３３', '１３Ａ', '１３Ｂ'],'4階':[ '１４１', '１４３', '１４５', '１４６', '１４Ａ', '２４１', '２４２'],'5階':[ '１５４'],'6階':[ '１６０', '１６１', '１６２', '１６Ａ']},'２時限':{'1階':[ '１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３２', '１３３', '１３Ａ', '１３Ｂ', '１３Ｄ'],'4階':[ '１４０', '１４１', '１４２', '１４３', '１４４', '１４５', '１４６', '１４７', '１４Ａ', '２４１', '２４２'],'5階':[ '１５０', '１５１', '１５２', '１５３', '１５４', '１５５', '１５６', '１５Ａ', '２５１', '２５２', '２５３'],'6階':[ '１６０', '１６１', '１６２', '１６５', '１６６', '１６７', '１６８', '１６Ａ']},'３時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３１', '１３２', '１３３', '１３Ａ', '１３Ｂ', '１３Ｄ'],'4階':[ '１４０', '１４１', '１４２', '１４３', '１４４', '１４５', '１４６', '１４７', '１４Ａ', '２４０', '２４１', '２４３', '２４５'],'5階':[ '１５０', '１５１', '１５３', '１５４', '１５５', '１５６', '１５Ａ', '２５０', '２５１', '２５２', '２５４', '２５５', '２５６', '２５７', '２５８'],'6階':[ '１６０', '１６１', '１６２', '１６４', '１６５', '１６６', '１６７', '１６８', '１６９', '１６Ａ']},'４時限':{'1階':[ '１１Ａ'],'2階':[ '１２Ａ'],'3階':[ '１３０', '１３１', '１３２', '１３Ａ', '１３Ｄ'],'4階':[ '１４０', '１４１', '１４５', '１４６', '１４Ａ', '２４０', '２４１', '２４３', '２４５', '２４７', '２４８', '２４９'],'5階':[ '１５０', '１５１', '１５３', '１５４', '１５５', '１５６', '１５７', '２５０', '２５１', '２５２', '２５３', '２５４', '２５６', '２５７', '２５９'],'6階':[ '１６０', '１６１', '１６２', '１６７', '１６８', '１６Ａ']},'５時限':{'2階':[ '１２Ａ'],'3階':['１３１', '１３Ａ', '１３Ｄ'] ,'4階':['１４０', '１４１', '１４５' , '２４１', '２４５', '２４８'] ,'5階':['１５０', '１５１', '１５３', '１５５', '２５０'] ,'6階':['１６１', '１６２', '１６Ａ']}},'Friday':{'１時限':{'1階':['１１Ａ'],'2階':['１２Ａ'] ,'3階':['１３２', '１３Ｄ'] ,'4階':['１４１', '１４４', '１４７', '２４１'] ,'5階':[ '１５４']},'２時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':['１３０', '１３２', '１３３', '１３Ａ', '１３Ｂ', '１３Ｄ'] ,'4階':['１４０', '１４１', '１４４', '１４５', '１４６', '１４７', '１４Ａ', '２４１', '２４８'] ,'5階':['１５０', '１５３', '１５４', '１５５', '１５６', '１５Ａ', '２５０'],'6階':['１６０', '１６１', '１６２', '１６４', '１６５', '１６７', '１６Ａ']},'３時限':{'1階':['１１Ａ'],'2階':['１２Ａ'] ,'3階':['１３０', '１３２', '１３Ａ', '１３Ｂ', '１３Ｄ'] ,'4階':['１４０', '１４２', '１４４', '１４６', '１４７', '１４Ａ', '２４１', '２４２'] ,'5階':['１５０', '１５１', '１５３', '１５５', '１５６', '１５７', '１５Ａ', '２５０', '２５４', '２５５'] , '6階':['１６２', '１６５', '１６６', '１６７', '１６Ａ']},'４時限':{'1階':['１１Ａ'],'2階':[ '１２Ａ'],'3階':['１３０', '１３１', '１３Ａ', '１３Ｄ'] ,'4階':['１４２', '１４６', '１４７', '２４１', '２４２', '２４３', '２４４', '２４５', '２４８'] , '5階':['１５０', '１５２', '１５３', '１５５', '１５６', '１５７', '１５Ａ', '２５１', '２５４', '２５５', '２５７'],'6階':['１６０', '１６２', '１６５', '１６６', '１６Ａ'] },'５時限':{'2階':['１２Ａ'], '3階':['１３０', '１３Ａ', '１３Ｄ'], '4階':['１４１', '１４２', '１４７', '２４４'],'5階':['１５０', '１５７', '２５１'] ,'6階':['１６０', '１６１', '１６６'] }}}
tower_500 = {'Monday':{'１時限':{'2階':['５２Ａ']},'２時限':{'1階':['５１Ａ', '５１Ｂ'],'2階':[ '５２Ａ', '５２Ｂ']},'３時限':{'1階':['５１Ａ', '５１Ｂ'],'2階':[ '５２Ａ', '５２Ｂ']} ,'４時限':{},'５時限':{'1階':['５１Ａ']}},'Tuesday':{'１時限':{'1階':['５１Ａ'],'2階':['５２Ａ'] , '4階':['５４１']},'２時限':{'1階':['５１Ａ', '５１Ｂ'], '2階':['５２Ａ', '５２Ｂ']},'３時限':{'1階':['５１Ａ', '５１Ｂ'],'2階':['５２Ａ', '５２Ｂ']} ,'４時限':{'1階':['５１Ａ','５１Ｂ'], '2階':['５２Ａ', '５２Ｂ'] },'５時限':{ '1階':['５１Ａ'], '2階':['５２Ａ']}},'Wednesday':{'１時限':{'1階':['５１２', '５１Ａ', '５１Ｂ'],'2階':['５２２', '５２Ａ', '５２Ｂ'] , '4階':['５４１'],'5階':['５５１']},'２時限':{'1階':['５１Ａ', '５１Ｂ'],'2階':['５２Ａ', '５２Ｂ'] ,'4階':['５４Ａ'] },'３時限':{ '1階':['５１Ｂ'], '2階':['５２Ａ', '５２Ｂ'],'4階':['５４Ａ'] },'４時限':{},'５時限':{}},'Thursday':{'１時限':{'1階':['５１Ａ'],'2階':['５２Ａ'] ,'4階':['５４Ａ'] },'２時限':{'1階':['５１Ａ', '５１Ｂ'],'2階':['５２Ａ', '５２Ｂ'] },'３時限':{'1階':['５１Ａ', '５１Ｂ'],'2階':['５２Ａ', '５２Ｂ'] },'４時限':{'1階':['５１Ａ', '５１Ｂ']},'５時限':{'1階':['５１Ａ'],'2階':[ '５２２', '５２Ａ']}},'Friday':{'１時限':{'1階':['５１Ａ', '５１Ｂ'],'4階':['５４Ａ'] },'２時限':{'1階':['５１Ａ', '５１Ｂ'],'2階':['５２Ａ'] ,'3階':['５３Ａ'] },'３時限':{'1階':['５１Ａ', '５１Ｂ'],'2階':['５２２', '５２Ａ'] },'４時限':{'2階':['５２Ａ']},'５時限':{}}}  
tower_600 = {'Monday':{'１時限':{},'２時限':{'2階':['６２１', '６２２'], '3階':['６３１']},'３時限':{ '2階':['６２１'],'3階':['６３１'] },'４時限':{'2階':['６２１'],'3階':['６３１'] },'５時限':{}},'Tuesday':{'１時限':{},'２時限':{'2階':['６２１'], '3階':['６３１']},'３時限':{'2階':['６２１', '６２２'], '3階':['６３１']},'４時限':{ '2階':['６２１'], '3階':['６３１']},'５時限':{}},'Wednesday':{'１時限':{},'２時限':{'2階':['６２１'] ,'3階':[ '６３１']},'３時限':{'2階':['６２１']},'４時限':{},'５時限':{}},'Thursday':{'１時限':{},'２時限':{'2階':['６２１'],'3階':['６３１'] },'３時限':{'2階':['６２１']},'４時限':{},'５時限':{}},'Friday':{'１時限':{},'２時限':{'６３１'},'３時限':{'2階':['６２１'], '3階':['６３１']},'４時限':{},'５時限':{}}}
tower_700 = {'Monday':{'１時限':{},'２時限':{'地下1階':['７０４'], '1階':['７１１', '７１２']},'３時限':{},'４時限':{},'５時限':{}},'Tuesday':{'１時限':{'2階':['７２４']},'２時限':{'1階':['７１１', '７１２', '７１３', '７１４'],'2階':['７２４'] },'３時限':{'1階':['７１１', '７１４']},'４時限':{},'５時限':{'2階':['７２１']}},'Wednesday':{'１時限':{},'２時限':{'1階':['７１１'],'2階':['７２４'] },'３時限':{'1階':['７１１', '７１４']},'４時限':{},'５時限':{}},'Thursday':{'１時限':{},'２時限':{'1階':['７１１', '７１４']},'３時限':{},'４時限':{},'５時限':{}},'Friday':{'１時限':{},'２時限':{'1階':['７１２']},'３時限':{},'４時限':{},'５時限':{}}}
tower_800 = {'Monday':{'１時限':{'2階':['８２７'],'4階':['ＬＬ５']},'２時限':{'1階':['８１Ａ', '８１Ｂ'], '2階':['８２０', '８２７', '８２Ａ', '８２Ｂ'],'4階':['ＬＬ３','ＬＬ５'],'6階':['ＡＶ４']},'３時限':{'2階':['８２２', '８２３', '８２Ａ', '８２Ｂ'],'4階':['ＬＬ１','ＬＬ３','ＬＬ４','ＬＬ５','ＬＬ６'] ,'6階':['ＡＶ４'] },'４時限':{'1階':['８１Ａ'],'2階':['８２３', '８２Ａ', '８２Ｂ'] ,'4階':['ＬＬ１', 'ＬＬ２', 'ＬＬ３', 'ＬＬ４', 'ＬＬ５', 'ＬＬ６'], '6階':['ＡＶ２','ＡＶ３', 'ＡＶ４']},'５時限':{'2階':['８２４', '８２６', '８２Ａ'],'4階':['ＬＬ１', 'ＬＬ２'] ,'6階':['ＡＶ２', 'ＡＶ３', 'ＡＶ４']}},'Tuesday':{'１時限':{'1階':['８１Ａ'],'2階':['８２Ａ', '８２Ｂ'] },'２時限':{'1階':['８１Ａ'],'2階':['８２Ａ', '８２Ｂ'] ,'4階':['ＬＬ２', 'ＬＬ４']},'３時限':{'2階':['８２２', '８２Ａ', '８２Ｂ'],'3階':['８３１'] ,'4階':['ＬＬ１', 'ＬＬ２', 'ＬＬ３', 'ＬＬ４', 'ＬＬ５', 'ＬＬ６'],'6階':['ＡＶ２', 'ＡＶ４']},'４時限':{'1階':['８１０', '８１３'],'2階':['８２２', '８２４', '８２６', '８２７', '８２８', '８２Ａ', '８２Ｂ'] ,'3階':['８３０'] ,'4階':['ＬＬ１', 'ＬＬ２', 'ＬＬ３', 'ＬＬ５', 'ＬＬ６'],'6階':['ＡＶ１', 'ＡＶ２', 'ＡＶ３', 'ＡＶ４']},'５時限':{'2階':[ '８２８', '８２Ａ', '８２Ｂ'],'3階':['８３０'] ,'4階':['ＬＬ１', 'ＬＬ６'],'6階':['ＡＶ２', 'ＡＶ３']}},'Wednesday':{'１時限':{'1階':['８１Ａ'],'2階':['８２０', '８２Ａ', '８２Ｂ'] ,'6階':['ＡＶ２', 'ＬＬ２'] },'２時限':{'1階':['８１０', '８１１', '８１３', '８１４', '８１５', '８１６', '８１７', '８１Ａ', '８１Ｂ'],'2階':['８２０', '８２２', '８２３', '８２４', '８２５', '８２６', '８２７', '８２８', '８２Ａ', '８２Ｂ'] ,'3階':['８３０', '８３１', '８３２', '８３３', '８３６'] , '4階':['ＬＬ４']},'３時限':{'2階':['８２Ａ', '８２Ｂ'],'4階':['ＬＬ１', 'ＬＬ２', 'ＬＬ３', 'ＬＬ４', 'ＬＬ５', 'ＬＬ６'],'6階':['ＡＶ１', 'ＡＶ２', 'ＡＶ４']},'４時限':{ '2階':['８２Ａ'],'4階':['ＬＬ１', 'ＬＬ２', 'ＬＬ３', 'ＬＬ４', 'ＬＬ５', 'ＬＬ６'],'6階':['ＡＶ１', 'ＡＶ２', 'ＡＶ３', 'ＡＶ４']},'５時限':{'2階':['８２Ａ'],'4階':['ＬＬ２', 'ＬＬ３', 'ＬＬ４'],'6階':['ＡＶ１']}},'Thursday':{'１時限':{'2階':['８２８'], '6階':['ＡＶ４']},'２時限':{'1階':['８１Ａ'],'2階':['８２Ｂ'],'6階':['ＡＶ４']},'３時限':{'2階':['８２０', '８２２', '８２４', '８２５', '８２Ａ', '８２Ｂ'],'4階':['ＬＬ２', 'ＬＬ３', 'ＬＬ４', 'ＬＬ６'],'6階':['ＡＶ２', 'ＡＶ４']},'４時限':{'2階':['８２４', '８２５', '８２Ａ', '８２Ｂ'],'4階':['ＬＬ１', 'ＬＬ２', 'ＬＬ３', 'ＬＬ４', 'ＬＬ５', 'ＬＬ６'],'6階':['ＡＶ３']},'５時限':{'2階':['８２２'],'4階':['ＬＬ１', 'ＬＬ２', 'ＬＬ４']}},'Friday':{'１時限':{'2階':['８２０'],'4階':['ＬＬ４']},'２時限':{'1階':['８１Ａ'],'2階':['８２Ａ'],'4階':['ＬＬ２', 'ＬＬ３', 'ＬＬ６'],'6階':['ＡＶ１']},'３時限':{'2階':['８２０', '８２２', '８２３', '８２Ａ', '８２Ｂ'],'4階':['ＬＬ１', 'ＬＬ２', 'ＬＬ３', 'ＬＬ６'],'6階':['ＡＶ４']},'４時限':{'2階':['８２３', '８２Ａ', '８２Ｂ'],'4階':['ＬＬ３', 'ＬＬ６'],'6階':['ＡＶ４']},'５時限':{'2階':['８２２', '８２３', '８２Ｂ']}}}
tower_1000 = {'Monday':{'１時限':{'1階':['１０１４'] ,'3階':['１０３１'] ,'4階':['１０４１', '１０４３'] ,'5階':['１０５５'] },'２時限':{'1階':['１０１３', '１０１４', '１０１５'],'3階':['１０３１'] , '4階':['１０４３'],'5階':['１０５１', '１０５２', '１０５３']},'３時限':{'1階':['１０１１', '１０１３', '１０１４', '１０１５'],'3階':['１０３１', '１０３２'] , '4階':['１０４１', '１０４２', '１０４３'],'5階':['１０５１', '１０５３', '１０５４', '１０５５', '１０５６'] },'４時限':{'1階':['１０１１', '１０１５'], '3階':['１０３１'],'4階':['１０４１', '１０４２', '１０４３', '１０４４'] ,'5階':['１０５１', '１０５３', '１０５４', '１０５５'] },'５時限':{'1階':['１０１１'],'3階':['１０３１'] ,'4階':['１０４１', '１０４２', '１０４３', '１０４４'] ,'5階':['１０５１', '１０５３', '１０５５'] }},'Tuesday':{'１時限':{'1階':['１０１１'], '3階':['１０３１'], '4階':['１０４１', '１０４３'], '5階':['１０５１', '１０５３', '１０５４', '１０５５', '１０５６']},'２時限':{'1階':['１０１１', '１０１４', '１０１５'],'3階':['１０３１'] ,'4階':['１０４１', '１０４２', '１０４３'] ,'5階':['１０５５'] },'３時限':{'1階':['１０１２', '１０１４', '１０１５'],'3階':['１０３２'] ,'4階':['１０４１', '１０４２'] ,'5階':[ '１０５１', '１０５３']},'４時限':{'1階':['１０１１', '１０１２', '１０１４'],'3階':['１０３１'] , '4階':['１０４１', '１０４２', '１０４３', '１０４４'], '5階':['１０５１', '１０５２', '１０５３', '１０５４']},'５時限':{'1階':['１０１１', '１０１４'],'3階':['１０３１'] ,'4階':['１０４１'] ,'5階':['１０５１', '１０５５'] }},'Wednesday':{'１時限':{'1階':['１０１１', '１０１２'],'3階':['１０３１'] ,'4階':['１０４１', '１０４４'] },'２時限':{'1階':['１０１２', '１０１４', '１０１５'], '3階':['１０３１', '１０３２'],'4階':[ '１０４１', '１０４２', '１０４３'], '5階':['１０５１', '１０５２', '１０５３', '１０５４', '１０５５', '１０５６']},'３時限':{'1階':['１０１１', '１０１２', '１０１３', '１０１４', '１０１５'],'3階':['１０３１'] , '4階':['１０４１', '１０４４'],'5階':['１０５２', '１０５３', '１０５４'] },'４時限':{'1階':['１０１１', '１０１４', '１０１５'], '3階':['１０３１'],'4階':['１０４１', '１０４２', '１０４４'] ,'5階':['１０５１', '１０５２'] },'５時限':{'1階':['１０１４', '１０１５'],'4階':['１０４４'] }},'Thursday':{'１時限':{'1階':['１０１１'],'3階':['１０３１'] , '4階':['１０４１', '１０４３', '１０４４'],'5階':['１０５３'] },'２時限':{'1階':['１０１１', '１０１４', '１０１５'],'3階':['１０３１'] ,'4階':['１０４１', '１０４４'] ,'5階':['１０５３', '１０５５', '１０５６'] },'３時限':{'1階':['１０１１', '１０１４'],'3階':['１０３１'] ,'4階':['１０４１', '１０４３'] ,'5階':['１０５１', '１０５２', '１０５３', '１０５５', '１０５６'] },'４時限':{'1階':['１０１１', '１０１３', '１０１４'],'3階':['１０３１', '１０３２'] ,'4階':['１０４１', '１０４２', '１０４３'] ,'5階':['１０５１', '１０５２', '１０５３', '１０５４'] },'５時限':{'3階':['１０３１'],'4階':['１０４１', '１０４３'] ,'5階':['１０５１', '１０５２'] }},'Friday':{'１時限':{'1階':['１０１４'], '4階':['１０４１'],'5階':['１０５１', '１０５６'] },'２時限':{'4階':['１０４３'], '5階':['１０５１', '１０５２', '１０５３', '１０５５']},'３時限':{'1階':['１０１１', '１０１４'],'4階':['１０４４'] ,'5階':['１０５２', '１０５３', '１０５４', '１０５５'] },'４時限':{'1階':['１０１１', '１０１４'],'4階':['１０４３', '１０４４'] , '5階':['１０５１', '１０５２', '１０５４', '１０５５']},'５時限':{'1階':['１０１１'],'5階':['１０５２']}}}  
place_list = [honnkann,tower_500,tower_600,tower_700,tower_800,tower_1000]
day_str = ['Monday','Tuesday','Wednesday','Thursday','Friday']

def search_classroom(request):
    """
    投稿検索
    - 場所検索
    - 曜日検索
    """
    if request.method == 'GET':
        place = int(request.GET.get('place',6))
        if place != 6:
            place_classroom = place_list[place]
            day = int(request.GET.get('day',6))
            if day != 6:
                day = day_str[day]
                day_classroom = place_classroom[day]
                return TemplateResponse(request, 'search_classroom.html',{'place_classroom':place_classroom,'place':place,'day':day,'day_classroom':day_classroom})
        return TemplateResponse(request, 'search_classroom.html',{'place':place})
    return TemplateResponse(request,'search_classroom.html')
        







